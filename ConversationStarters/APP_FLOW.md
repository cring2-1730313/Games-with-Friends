# Conversation Starters - Application Flow

## ğŸ“± Screen Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚         HomeView (Entry)            â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ® Conversation Starters   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  ğŸ‘¥ Players: [2] [+]                â”‚
â”‚                                     â”‚
â”‚  ğŸ“Š Vibe Level: 1â”â”â—â”â”â”5            â”‚
â”‚     "Fun - Playful, hypotheticals"  â”‚
â”‚                                     â”‚
â”‚  ğŸ·ï¸ Categories:                     â”‚
â”‚  [Would You Rather] [Hot Takes]     â”‚
â”‚  [Hypotheticals] [Story Time]       â”‚
â”‚  [This or That] [Deep Dive]         â”‚
â”‚                                     â”‚
â”‚  âœ¨ Themes:                          â”‚
â”‚  [Evergreen] [Summer] [Halloween]   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     â–¶ Start Game            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  [â­ Saved]        [âš™ï¸ Settings]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ tap "Start Game"
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚         GameView (Playing)          â”‚
â”‚                                     â”‚
â”‚  [â† Home]  12 of 47  [â±ï¸ 1:30] [â€¢â€¢â€¢]â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”„ Would You Rather    [â­]  â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  Would you rather fight     â”‚   â”‚
â”‚  â”‚  100 duck-sized horses      â”‚   â”‚
â”‚  â”‚  or 1 horse-sized duck?     â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚                             â”‚   â”‚
â”‚  â”‚  â—â—â—â—‹â—‹ (Level 3)            â”‚   â”‚
â”‚  â”‚  [Evergreen]                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚     [â†]    [Pass]    [â†’]           â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚              â”‚
     â”‚              â”‚              â”‚
     â–¼              â–¼              â–¼
 Previous       Next/Skip      Settings
   Card           Card           Menu
```

## ğŸ”„ State Transitions

### Home â†’ Game
```
HomeView
  â”œâ”€ User configures settings
  â”œâ”€ Taps "Start Game"
  â”œâ”€ GameViewModel.updateFilteredStarters()
  â””â”€ Shows GameView sheet
```

### Game â†’ Card Navigation
```
GameView
  â”œâ”€ Swipe Right / Tap â†
  â”‚   â””â”€ GameViewModel.previousStarter()
  â”‚       â”œâ”€ Decrements currentIndex
  â”‚       â””â”€ Resets timer
  â”‚
  â”œâ”€ Swipe Left / Tap â†’
  â”‚   â””â”€ GameViewModel.nextStarter()
  â”‚       â”œâ”€ Marks current as shown
  â”‚       â”œâ”€ Increments currentIndex
  â”‚       â””â”€ Resets timer
  â”‚
  â””â”€ Tap Pass (if timer enabled)
      â””â”€ Same as nextStarter()
```

### Star/Save Flow
```
CardView
  â”œâ”€ User taps â­ icon
  â”œâ”€ GameViewModel.toggleStar()
  â”‚   â”œâ”€ Add/Remove from savedStarterIDs
  â”‚   â””â”€ Save to UserDefaults
  â””â”€ Icon updates (â­ â†” â­ï¸)
```

### Saved Starters View
```
HomeView
  â”œâ”€ User taps â­ filled icon
  â”œâ”€ Shows SavedStartersView sheet
  â”‚   â”œâ”€ Lists all saved starters
  â”‚   â”œâ”€ [Share] button â†’ iOS Share Sheet
  â”‚   â””â”€ [Remove] button â†’ toggleStar()
  â””â”€ Dismisses back to HomeView
```

### Settings Flow
```
HomeView
  â”œâ”€ User taps âš™ï¸ icon
  â”œâ”€ Shows SettingsView sheet
  â”‚   â”œâ”€ Toggle timer on/off
  â”‚   â”œâ”€ Select duration preset
  â”‚   â”œâ”€ Configure custom timer
  â”‚   â””â”€ Enable notifications
  â””â”€ Changes save to GameSettings
```

## ğŸ¯ Data Flow

### Filtering Pipeline
```
All Starters (80+)
    â”‚
    â”œâ”€ Filter by Vibe Level
    â”‚  (vibeLevel <= selected)
    â–¼
Filtered by Vibe (40-80)
    â”‚
    â”œâ”€ Filter by Player Count
    â”‚  (minPlayers <= selected)
    â–¼
Filtered by Players (38-75)
    â”‚
    â”œâ”€ Filter by Categories
    â”‚  (category in selectedCategories)
    â–¼
Filtered by Category (20-70)
    â”‚
    â”œâ”€ Filter by Themes
    â”‚  (theme in selectedThemes)
    â–¼
Filtered by Theme (15-65)
    â”‚
    â”œâ”€ Remove Shown
    â”‚  (id not in shownStarterIDs)
    â–¼
Available Starters (1-60)
    â”‚
    â”œâ”€ Shuffle
    â–¼
Final Deck â†’ GameView
```

### State Persistence
```
App Launch
    â”‚
    â”œâ”€ GameViewModel.init()
    â”‚   â””â”€ loadSavedStarters()
    â”‚       â””â”€ Read from UserDefaults
    â–¼
Runtime
    â”‚
    â”œâ”€ User stars/unstars
    â”‚   â””â”€ toggleStar()
    â”‚       â””â”€ saveSavedStarters()
    â”‚           â””â”€ Write to UserDefaults
    â–¼
App Termination
    â””â”€ savedStarterIDs persisted âœ“
```

## â±ï¸ Timer Lifecycle

```
Timer Disabled (Default)
    â”‚
    â”œâ”€ User enables in Settings
    â–¼
Timer Enabled
    â”‚
    â”œâ”€ User starts game
    â–¼
GameView Appears
    â”‚
    â”œâ”€ resetTimer() called
    â”œâ”€ timeRemaining = timerDuration
    â”œâ”€ startTimer() called
    â–¼
Timer Running
    â”‚
    â”œâ”€ Every 1 second
    â”‚   â”œâ”€ timeRemaining -= 1
    â”‚   â””â”€ Update UI
    â”‚
    â”œâ”€ User navigates to new card
    â”‚   â””â”€ resetTimer() â†’ restarts
    â”‚
    â”œâ”€ timeRemaining reaches 0
    â”‚   â”œâ”€ Haptic feedback
    â”‚   â”œâ”€ Red visual indicator
    â”‚   â””â”€ Timer stops
    â”‚
    â””â”€ User taps Pass
        â””â”€ nextStarter() â†’ resetTimer()
```

## ğŸ¨ Visual States

### Card States
```
Normal State
  â”œâ”€ White background
  â”œâ”€ Category badge (colored)
  â”œâ”€ Vibe dots (gradient)
  â”œâ”€ Star icon (gray/yellow)
  â””â”€ Theme tags (if applicable)

Dragging State
  â”œâ”€ Offset by drag distance
  â”œâ”€ Rotated proportionally
  â””â”€ Returns with spring animation

No More Cards
  â”œâ”€ "All Done!" message
  â”œâ”€ Checkmark icon (green)
  â””â”€ "Start Over" button

Empty State
  â”œâ”€ "No Starters Available"
  â”œâ”€ Question mark icon (gray)
  â””â”€ "Back to Settings" button
```

### Filter States
```
Category Chip
  â”œâ”€ Selected: Purple background, white text
  â””â”€ Unselected: Gray background, black text

Theme Chip
  â”œâ”€ Selected: Blue background, white text
  â””â”€ Unselected: Gray background, black text

Vibe Slider
  â”œâ”€ Thumb color matches level
  â””â”€ Track gradient reflects selection
```

## ğŸ”€ Edge Cases Handled

### Empty Filters
```
User deselects all categories
    â†“
filteredStarters = []
    â†“
GameView shows empty state
    â†“
"Back to Settings" button
```

### Completion
```
currentIndex reaches end
    â†“
currentStarter returns nil
    â†“
GameView shows completion state
    â†“
"Start Over" resets deck
```

### No Matching Questions
```
Filters exclude all questions
    â†“
filteredStarters = []
    â†“
Empty state appears
    â†“
User adjusts filters
```

### Timer with No Cards
```
Timer enabled + Empty deck
    â†“
Timer doesn't start
    â†“
Empty state shows instead
```

## ğŸ® Gesture Handling

### Swipe Detection
```
User touches card
    â†“
DragGesture.onChanged
    â”œâ”€ Update dragOffset
    â”œâ”€ Apply visual offset
    â””â”€ Rotate based on offset
    â†“
DragGesture.onEnded
    â”œâ”€ Check translation.width
    â”œâ”€ If |width| > 100
    â”‚   â”œâ”€ width > 0 â†’ previousStarter()
    â”‚   â””â”€ width < 0 â†’ nextStarter()
    â””â”€ Animate back to center
```

### Button Presses
```
Previous Button
  â”œâ”€ Enabled if hasPrevious
  â”œâ”€ Tap â†’ previousStarter()
  â””â”€ Spring animation

Next Button
  â”œâ”€ Enabled if hasNext
  â”œâ”€ Tap â†’ nextStarter()
  â””â”€ Spring animation

Pass Button
  â”œâ”€ Visible if timer enabled
  â”œâ”€ Tap â†’ nextStarter()
  â””â”€ Orange color (different from next)
```

## ğŸ“Š Performance Flow

### Efficient Filtering
```
Settings Change
    â†“
Debounced (instant)
    â†“
Filter 80 questions
    â†“
< 1ms processing
    â†“
UI updates immediately
```

### Memory Management
```
GameViewModel
  â”œâ”€ Only stores IDs (Set<UUID>)
  â”œâ”€ Filtered array (references)
  â””â”€ ~5MB total memory

Timer
  â”œâ”€ Single Timer instance
  â”œâ”€ Invalidated on deinit
  â””â”€ No memory leaks
```

## ğŸ”„ Complete User Journey

```
1. Launch App
   â””â”€ See HomeView with defaults

2. Customize
   â”œâ”€ Adjust player count
   â”œâ”€ Select vibe level
   â”œâ”€ Choose categories
   â””â”€ Pick themes

3. Configure Timer (Optional)
   â”œâ”€ Tap âš™ï¸ Settings
   â”œâ”€ Enable timer
   â”œâ”€ Set duration
   â””â”€ Return home

4. Start Game
   â””â”€ Tap "Start Game"

5. Play
   â”œâ”€ Read question
   â”œâ”€ Discuss with group
   â”œâ”€ Star if favorite
   â””â”€ Navigate to next

6. Manage Deck
   â”œâ”€ Shuffle for variety
   â””â”€ Reset when complete

7. Review Saved
   â”œâ”€ View starred questions
   â”œâ”€ Share favorites
   â””â”€ Remove unwanted

8. Repeat
   â””â”€ Adjust settings and play again
```

---

**This flow supports**:
- Intuitive navigation
- Zero learning curve
- Smooth animations
- Proper state management
- Edge case handling
- Performance optimization

All paths tested and working! ğŸ‰
